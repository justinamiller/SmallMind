SmallMind Code Profiler
========================

Mode: enhanced

╔════════════════════════════════════════════════════════════════╗
║       SmallMind Comprehensive Performance Profiling           ║
╚════════════════════════════════════════════════════════════════╝

┌─ Phase 1: Low-Level SIMD Operations ──────────────────────────┐
│ Testing fundamental kernels...                                │
└────────────────────────────────────────────────────────────────┘

  MatMul 64×64... ✓
  MatMul 128×128... ✓
  MatMul 256×256... ✓
  MatMul 512×512... ✓
  GELU 1000 elements... ✓
  GELU 10000 elements... ✓
  GELU 100000 elements... ✓
  GELU 1000000 elements... ✓
  Softmax 256... ✓
  Softmax 512... ✓
  Softmax 1024... ✓
  Softmax 2048... ✓

┌─ Phase 2: Tensor Operations ──────────────────────────────────┐
│ Testing mid-level tensor operations...                        │
└────────────────────────────────────────────────────────────────┘

  Tensor Addition... ✓
  Tensor Multiplication... ✓
  Broadcasting Add... ✓

┌─ Phase 3: Transformer Inference ──────────────────────────────┐
│ Testing full transformer pipeline...                          │
└────────────────────────────────────────────────────────────────┘

  Small Model (128 dim, 2 layers):
    Creating Small model... TransformerModel initialized: vocab=256, block_size=64, n_embd=128, n_layer=2, n_head=4, dropout=0
Total parameters: 470,528 (29 tensors)
✓ (29 tensors)
    Generating 25 tokens... ✓ (35 total tokens)
  Medium Model (256 dim, 4 layers):
    Creating Medium model... TransformerModel initialized: vocab=512, block_size=128, n_embd=256, n_layer=4, n_head=8, dropout=0
Total parameters: 3,454,464 (53 tensors)
✓ (53 tensors)
    Generating 25 tokens... ✓ (35 total tokens)


╔════════════════════════════════════════════════════════════════╗
║                    PROFILING RESULTS                           ║
╚════════════════════════════════════════════════════════════════╝

═══ Top 30 Hot Paths (by Time) ════════════════════════════════

Rank  Method                                   Time (ms)       Calls      Avg (ms)     Alloc (MB)  
────────────────────────────────────────────────────────────────────────────────────────────────────
1     Model_Medium_Inference                   1201.28         1          1201.279     729.97      
2     Model_Medium_GenerateToken               1201.18         25         48.047       729.96      
3     Model_Medium_Forward                     1200.76         25         48.030       729.96      
4     Model_Small_Inference                    531.64          1          531.637      109.26      
5     Model_Small_GenerateToken                531.59          25         21.264       109.26      
6     Model_Small_Forward                      529.00          25         21.160       109.26      
7     MatMul_512x512                           172.11          1          172.113      0.00        
8     MatMul_Iteration                         148.10          12         12.341       0.00        
9     GELU_1000000                             100.60          1          100.604      0.01        
10    GELU_Iteration                           90.44           20         4.522        0.00        
11    Model_Medium_Creation                    84.98           1          84.983       26.45       
12    Model_Small_Creation                     34.51           1          34.505       3.61        
13    MatMul_256x256                           19.59           1          19.591       0.00        
14    GELU_100000                              11.06           1          11.061       0.01        
15    TensorAdd_10000                          10.84           1          10.845       0.38        
16    TensorAdd_Iteration                      10.83           10         1.083        0.38        
17    Softmax_256                              7.21            1          7.211        0.00        
18    MatMul_64x64                             7.07            1          7.072        0.00        
19    BroadcastAdd_100x100                     6.93            1          6.925        0.38        
20    BroadcastAdd_Iteration                   6.91            10         0.691        0.38        
21    Softmax_Iteration                        6.36            20         0.318        0.00        
22    Softmax_2048                             6.22            1          6.221        0.00        
23    MatMul_128x128                           3.54            1          3.543        0.00        
24    GELU_1000                                2.28            1          2.278        0.00        
25    GELU_10000                               1.17            1          1.166        0.00        
26    TensorMul_10000                          0.60            1          0.599        0.38        
27    TensorMul_Iteration                      0.59            10         0.059        0.38        
28    Softmax_1024                             0.15            1          0.150        0.00        
29    Softmax_512                              0.06            1          0.063        0.00        

═══ Memory Allocation Analysis ════════════════════════════════

Rank  Method                                        Total (MB)      Calls      Avg (KB)    
───────────────────────────────────────────────────────────────────────────────────────────────
1     Model_Medium_Inference                        729.97          1          747486.22   
2     Model_Medium_GenerateToken                    729.96          25         29899.13    
3     Model_Medium_Forward                          729.96          25         29899.13    
4     Model_Small_Inference                         109.26          1          111884.45   
5     Model_Small_GenerateToken                     109.26          25         4475.38     
6     Model_Small_Forward                           109.26          25         4475.38     
7     Model_Medium_Creation                         26.45           1          27080.12    
8     Model_Small_Creation                          3.61            1          3697.85     
9     TensorAdd_10000                               0.38            1          390.86      
10    TensorAdd_Iteration                           0.38            10         39.09       
11    TensorMul_10000                               0.38            1          390.86      
12    TensorMul_Iteration                           0.38            10         39.09       
13    BroadcastAdd_100x100                          0.38            1          390.86      
14    BroadcastAdd_Iteration                        0.38            10         39.09       
15    GELU_1000000                                  0.01            1          8.28        

═══ Summary Statistics ═════════════════════════════════════════

  Total Profiled Time:        5927.59 ms
  Total Memory Allocated:     2550.03 MB
  Total Method Calls:         201
  Unique Methods Profiled:    29

✓ Detailed report saved to: enhanced-profile-report.md

